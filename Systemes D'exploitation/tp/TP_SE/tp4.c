#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>
#include<fcntl.h>
#include<errno.h>
#include<string.h>
#include<fcntl.h>
#include<sys/stat.h>
#include<pwd.h>
#include<sys/types.h>
#include<time.h>
#include<grp.h>

int main(int argc , char *argv[]){
     struct stat StatusBuffer;
for(int i=1;i<argc;i++){
     if (stat(argv[i],&StatusBuffer)==-1)
        {
            perror(argv[i]);
            exit(1);        }
    printf(" Nom du fuchier : %s\n",argv[i]);
    printf("Droits d'acces (mode octal ): %o \n",StatusBuffer.st_mode & 0777);
    

    if(S_ISREG(StatusBuffer.st_mode)){
        printf("%s est un repertoire \n",argv[i]);
        }else if(S_ISDIR(StatusBuffer.st_mode)){
            printf("%s est un repertoire \n",argv[i]);
        };
        printf("les droits d'acces de USR suivie GRP survie OTH en mode Symbolique sont : ");
        printf("%c", StatusBuffer.st_mode & S_IRUSR ? 'R':'-');
        printf("%c", StatusBuffer.st_mode & S_IWUSR ? 'W':'-');
        printf("%c", StatusBuffer.st_mode & S_IXUSR ? 'X':'-');
        printf("%c", StatusBuffer.st_mode & S_IRGRP ? 'R':'-');
        printf("%c", StatusBuffer.st_mode & S_IWGRP ? 'W':'-');
        printf("%c", StatusBuffer.st_mode & S_IXGRP ? 'X':'-');
        printf("%c", StatusBuffer.st_mode & S_IROTH ? 'R':'-');
        printf("%c", StatusBuffer.st_mode & S_IWOTH ? 'W':'-');
        printf("%c", StatusBuffer.st_mode & S_IXOTH ? 'X':'-');
        printf("\nDate de derniere modification : %s",ctime(&StatusBuffer.st_mtime));
        printf("Owner:    %s\n",getpwuid(StatusBuffer.st_uid)->pw_name);
        printf("groupe:    %s\n",getgrgid(StatusBuffer.st_gid)->gr_name);
        printf("Taille:   %ld\n",StatusBuffer.st_size);
        printf("nombre de lien physique:   %ld\n",StatusBuffer.st_nlink);
       // printf("\nTime:   %ld\n",ctime(StatusBuffer.st_atime));

}


   return EXIT_SUCCESS; 
     
}