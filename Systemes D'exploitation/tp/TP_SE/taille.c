#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>
#include<fcntl.h>
#include<errno.h>
#include<string.h>

// replace cat fonction with this script

int main(int argc, char *argv[]){
    // declaration des var
    int fl,taille,Access,Permission;
    char buf;
//on va boucler un nombre d'argument fois 
    for(int i=1;i<argc;i++){
        Permission=0;
         printf("\nfile : %s.",argv[i]);
        // on verifie les droits d'access a notre file 
        // dans ce cas on a besoin de la permission read pour defiler sur toute la longeur du fichier 
     if(access(argv[i],F_OK)==-1){
        
         if (errno==ENOENT)
         {
            printf("\nA component of path does not name an existing file or path is an empty string.\n");
         }else if(errno==EACCES)printf("Permission bits of the file mode do not permit the requested access, or search permission is denied on a component of the path prefix.\n");
         
         

     }
     if(access(argv[i],R_OK)==-1){
         if (errno==EACCES)
         {
            printf("\nPermission bits of the file mode do not permit the requested access, or search permission is denied on a component of the path prefix.\n");
         }else{printf("\nthe read permission isn't granted for %s\n",argv[i]);}
         
         

     }

     // on verifie si les deux flags sont ok
     Permission=access(argv[i],R_OK)+access(argv[i],F_OK);
     
        if(Permission==0){
                printf("\n\nF_OK & R_OK sont a 0 ==> permission ok\n");




         // on copie l'index du fichier 
            fl=open(argv[i],O_RDONLY);
             if(fl==-1){
                    printf("\nle %s n'existe pas\n",argv[i]);
            }else{
        
                printf("file number %d named %s\n", i ,argv[i]);
                taille=0;
        
                    while (read(fl,&buf,1))
                        {
                            taille++;
                            write(1,&buf,1);
            
                        }
                printf("\nla taille du %s est de :%dCHAR\n",argv[i],taille);
                close(fl);
                }

        }
        

    }

return(0);
}